epoch 0
SGD with respect to sample 0
begin forward pass
shape of a (before sigmoid):
(4,)
value of a (before sigmoid):
[0. 0. 0. 0.]
shape of z (after sigmoid):
(5,)
value of z (after sigmoid):
[1.  0.5 0.5 0.5 0.5]
shape of b (before softmax):
(10,)
value of b (before softmax):
[0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
shape of y-hat (after softmax):
(10,)
value of y-hat (after softmax):
[0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1]
cross entropy loss:
2.3025850929940455
begin backward pass
shape of d(loss)/d(b):
(10, 1)
value of d(loss)/d(b):
[[ 0.1]
 [ 0.1]
 [ 0.1]
 [ 0.1]
 [ 0.1]
 [ 0.1]
 [ 0.1]
 [ 0.1]
 [ 0.1]
 [-0.9]]
shape of d(loss)/d(w2):
(10, 5)
value of d(loss)/d(w2):
[[ 0.1   0.05  0.05  0.05  0.05]
 [ 0.1   0.05  0.05  0.05  0.05]
 [ 0.1   0.05  0.05  0.05  0.05]
 [ 0.1   0.05  0.05  0.05  0.05]
 [ 0.1   0.05  0.05  0.05  0.05]
 [ 0.1   0.05  0.05  0.05  0.05]
 [ 0.1   0.05  0.05  0.05  0.05]
 [ 0.1   0.05  0.05  0.05  0.05]
 [ 0.1   0.05  0.05  0.05  0.05]
 [-0.9  -0.45 -0.45 -0.45 -0.45]]
shape of d(loss)/d(z):
(4, 1)
value of d(loss)/d(z):
[[0.]
 [0.]
 [0.]
 [0.]]
shape of d(loss)/d(a):
(4, 1)
value of d(loss)/d(a):
[[0.]
 [0.]
 [0.]
 [0.]]
shape of d(loss)/d(w1):
(4, 6)
value of d(loss)/d(w1):
[[0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0.]]
update parameters with Adagrad
shape of grad_sum_w1:
(4, 6)
value of grad_sum_w1:
[[0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0.]]
shape of grad_sum_w2:
(10, 5)
value of grad_sum_w2:
[[0.01   0.0025 0.0025 0.0025 0.0025]
 [0.01   0.0025 0.0025 0.0025 0.0025]
 [0.01   0.0025 0.0025 0.0025 0.0025]
 [0.01   0.0025 0.0025 0.0025 0.0025]
 [0.01   0.0025 0.0025 0.0025 0.0025]
 [0.01   0.0025 0.0025 0.0025 0.0025]
 [0.01   0.0025 0.0025 0.0025 0.0025]
 [0.01   0.0025 0.0025 0.0025 0.0025]
 [0.01   0.0025 0.0025 0.0025 0.0025]
 [0.81   0.2025 0.2025 0.2025 0.2025]]
shape of lr_w1:
(4, 6)
value of lr_w1:
[[0.99950037 1.99601196 1.99601196 1.99601196 1.99601196]
 [0.99950037 1.99601196 1.99601196 1.99601196 1.99601196]
 [0.99950037 1.99601196 1.99601196 1.99601196 1.99601196]
 [0.99950037 1.99601196 1.99601196 1.99601196 1.99601196]
 [0.99950037 1.99601196 1.99601196 1.99601196 1.99601196]
 [0.99950037 1.99601196 1.99601196 1.99601196 1.99601196]
 [0.99950037 1.99601196 1.99601196 1.99601196 1.99601196]
 [0.99950037 1.99601196 1.99601196 1.99601196 1.99601196]
 [0.99950037 1.99601196 1.99601196 1.99601196 1.99601196]
 [0.11111043 0.22221674 0.22221674 0.22221674 0.22221674]]
shape of lr_w2:
(10, 5)
value of lr_w2:
[[0.99950037 1.99601196 1.99601196 1.99601196 1.99601196]
 [0.99950037 1.99601196 1.99601196 1.99601196 1.99601196]
 [0.99950037 1.99601196 1.99601196 1.99601196 1.99601196]
 [0.99950037 1.99601196 1.99601196 1.99601196 1.99601196]
 [0.99950037 1.99601196 1.99601196 1.99601196 1.99601196]
 [0.99950037 1.99601196 1.99601196 1.99601196 1.99601196]
 [0.99950037 1.99601196 1.99601196 1.99601196 1.99601196]
 [0.99950037 1.99601196 1.99601196 1.99601196 1.99601196]
 [0.99950037 1.99601196 1.99601196 1.99601196 1.99601196]
 [0.11111043 0.22221674 0.22221674 0.22221674 0.22221674]]
shape of new w1:
(4, 6)
value of new w1:
[[0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0.]]
shape of new w2:
(10, 5)
value of new w2:
[[-0.09995004 -0.0998006  -0.0998006  -0.0998006  -0.0998006 ]
 [-0.09995004 -0.0998006  -0.0998006  -0.0998006  -0.0998006 ]
 [-0.09995004 -0.0998006  -0.0998006  -0.0998006  -0.0998006 ]
 [-0.09995004 -0.0998006  -0.0998006  -0.0998006  -0.0998006 ]
 [-0.09995004 -0.0998006  -0.0998006  -0.0998006  -0.0998006 ]
 [-0.09995004 -0.0998006  -0.0998006  -0.0998006  -0.0998006 ]
 [-0.09995004 -0.0998006  -0.0998006  -0.0998006  -0.0998006 ]
 [-0.09995004 -0.0998006  -0.0998006  -0.0998006  -0.0998006 ]
 [-0.09995004 -0.0998006  -0.0998006  -0.0998006  -0.0998006 ]
 [ 0.09999938  0.09999753  0.09999753  0.09999753  0.09999753]]
SGD with respect to sample 1
begin forward pass
shape of a (before sigmoid):
(4,)
value of a (before sigmoid):
[0. 0. 0. 0.]
shape of z (after sigmoid):
(5,)
value of z (after sigmoid):
[1.  0.5 0.5 0.5 0.5]
shape of b (before softmax):
(10,)
value of b (before softmax):
[-0.29955123 -0.29955123 -0.29955123 -0.29955123 -0.29955123 -0.29955123
 -0.29955123 -0.29955123 -0.29955123  0.29999444]
shape of y-hat (after softmax):
(10,)
value of y-hat (after softmax):
[0.09241041 0.09241041 0.09241041 0.09241041 0.09241041 0.09241041
 0.09241041 0.09241041 0.09241041 0.16830627]
cross entropy loss:
2.3815155971645616
begin backward pass
shape of d(loss)/d(b):
(10, 1)
value of d(loss)/d(b):
[[ 0.09241041]
 [ 0.09241041]
 [ 0.09241041]
 [ 0.09241041]
 [ 0.09241041]
 [ 0.09241041]
 [ 0.09241041]
 [-0.90758959]
 [ 0.09241041]
 [ 0.16830627]]
shape of d(loss)/d(w2):
(10, 5)
value of d(loss)/d(w2):
[[ 0.09241041  0.04620521  0.04620521  0.04620521  0.04620521]
 [ 0.09241041  0.04620521  0.04620521  0.04620521  0.04620521]
 [ 0.09241041  0.04620521  0.04620521  0.04620521  0.04620521]
 [ 0.09241041  0.04620521  0.04620521  0.04620521  0.04620521]
 [ 0.09241041  0.04620521  0.04620521  0.04620521  0.04620521]
 [ 0.09241041  0.04620521  0.04620521  0.04620521  0.04620521]
 [ 0.09241041  0.04620521  0.04620521  0.04620521  0.04620521]
 [-0.90758959 -0.45379479 -0.45379479 -0.45379479 -0.45379479]
 [ 0.09241041  0.04620521  0.04620521  0.04620521  0.04620521]
 [ 0.16830627  0.08415314  0.08415314  0.08415314  0.08415314]]
shape of d(loss)/d(z):
(4, 1)
value of d(loss)/d(z):
[[0.03362728]
 [0.03362728]
 [0.03362728]
 [0.03362728]]
shape of d(loss)/d(a):
(4, 1)
value of d(loss)/d(a):
[[0.00840682]
 [0.00840682]
 [0.00840682]
 [0.00840682]]
shape of d(loss)/d(w1):
(4, 6)
value of d(loss)/d(w1):
[[0.00840682 0.         0.00840682 0.00840682 0.00840682 0.        ]
 [0.00840682 0.         0.00840682 0.00840682 0.00840682 0.        ]
 [0.00840682 0.         0.00840682 0.00840682 0.00840682 0.        ]
 [0.00840682 0.         0.00840682 0.00840682 0.00840682 0.        ]]
update parameters with Adagrad
shape of grad_sum_w1:
(4, 6)
value of grad_sum_w1:
[[7.06746141e-05 0.00000000e+00 7.06746141e-05 7.06746141e-05
  7.06746141e-05 0.00000000e+00]
 [7.06746141e-05 0.00000000e+00 7.06746141e-05 7.06746141e-05
  7.06746141e-05 0.00000000e+00]
 [7.06746141e-05 0.00000000e+00 7.06746141e-05 7.06746141e-05
  7.06746141e-05 0.00000000e+00]
 [7.06746141e-05 0.00000000e+00 7.06746141e-05 7.06746141e-05
  7.06746141e-05 0.00000000e+00]]
shape of grad_sum_w2:
(10, 5)
value of grad_sum_w2:
[[0.01853968 0.00463492 0.00463492 0.00463492 0.00463492]
 [0.01853968 0.00463492 0.00463492 0.00463492 0.00463492]
 [0.01853968 0.00463492 0.00463492 0.00463492 0.00463492]
 [0.01853968 0.00463492 0.00463492 0.00463492 0.00463492]
 [0.01853968 0.00463492 0.00463492 0.00463492 0.00463492]
 [0.01853968 0.00463492 0.00463492 0.00463492 0.00463492]
 [0.01853968 0.00463492 0.00463492 0.00463492 0.00463492]
 [0.83371886 0.20842971 0.20842971 0.20842971 0.20842971]
 [0.01853968 0.00463492 0.00463492 0.00463492 0.00463492]
 [0.838327   0.20958175 0.20958175 0.20958175 0.20958175]]
shape of lr_w1:
(4, 6)
value of lr_w1:
[[0.73422934 1.46727266 1.46727266 1.46727266 1.46727266]
 [0.73422934 1.46727266 1.46727266 1.46727266 1.46727266]
 [0.73422934 1.46727266 1.46727266 1.46727266 1.46727266]
 [0.73422934 1.46727266 1.46727266 1.46727266 1.46727266]
 [0.73422934 1.46727266 1.46727266 1.46727266 1.46727266]
 [0.73422934 1.46727266 1.46727266 1.46727266 1.46727266]
 [0.73422934 1.46727266 1.46727266 1.46727266 1.46727266]
 [0.10951852 0.21903311 0.21903311 0.21903311 0.21903311]
 [0.73422934 1.46727266 1.46727266 1.46727266 1.46727266]
 [0.10921711 0.21843031 0.21843031 0.21843031 0.21843031]]
shape of lr_w2:
(10, 5)
value of lr_w2:
[[0.73422934 1.46727266 1.46727266 1.46727266 1.46727266]
 [0.73422934 1.46727266 1.46727266 1.46727266 1.46727266]
 [0.73422934 1.46727266 1.46727266 1.46727266 1.46727266]
 [0.73422934 1.46727266 1.46727266 1.46727266 1.46727266]
 [0.73422934 1.46727266 1.46727266 1.46727266 1.46727266]
 [0.73422934 1.46727266 1.46727266 1.46727266 1.46727266]
 [0.73422934 1.46727266 1.46727266 1.46727266 1.46727266]
 [0.10951852 0.21903311 0.21903311 0.21903311 0.21903311]
 [0.73422934 1.46727266 1.46727266 1.46727266 1.46727266]
 [0.10921711 0.21843031 0.21843031 0.21843031 0.21843031]]
shape of new w1:
(4, 6)
value of new w1:
[[-0.09359729  0.         -0.09359729 -0.09359729 -0.09359729  0.        ]
 [-0.09359729  0.         -0.09359729 -0.09359729 -0.09359729  0.        ]
 [-0.09359729  0.         -0.09359729 -0.09359729 -0.09359729  0.        ]
 [-0.09359729  0.         -0.09359729 -0.09359729 -0.09359729  0.        ]]
shape of new w2:
(10, 5)
value of new w2:
[[-0.16780047 -0.16759624 -0.16759624 -0.16759624 -0.16759624]
 [-0.16780047 -0.16759624 -0.16759624 -0.16759624 -0.16759624]
 [-0.16780047 -0.16759624 -0.16759624 -0.16759624 -0.16759624]
 [-0.16780047 -0.16759624 -0.16759624 -0.16759624 -0.16759624]
 [-0.16780047 -0.16759624 -0.16759624 -0.16759624 -0.16759624]
 [-0.16780047 -0.16759624 -0.16759624 -0.16759624 -0.16759624]
 [-0.16780047 -0.16759624 -0.16759624 -0.16759624 -0.16759624]
 [-0.00055217 -0.00040451 -0.00040451 -0.00040451 -0.00040451]
 [-0.16780047 -0.16759624 -0.16759624 -0.16759624 -0.16759624]
 [ 0.08161746  0.08161594  0.08161594  0.08161594  0.08161594]]